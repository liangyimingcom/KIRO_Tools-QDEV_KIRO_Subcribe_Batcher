# ç”Ÿäº§ç¯å¢ƒé¡¹ç›®ç»“æ„

**ç‰ˆæœ¬**: 1.0  
**æ—¥æœŸ**: 2025-12-01  
**çŠ¶æ€**: âœ… ç”Ÿäº§å°±ç»ª

---

## ğŸ“ ç”Ÿäº§ç¯å¢ƒç›®å½•ç»“æ„

```
é¡¹ç›®æ ¹ç›®å½•/
â”œâ”€â”€ src/                          # æºä»£ç ç›®å½•ï¼ˆå¿…éœ€ï¼‰
â”‚   â”œâ”€â”€ models.py                # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ config.py                # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ logger.py                # æ—¥å¿—è®°å½•
â”‚   â”œâ”€â”€ csv_parser.py            # CSVè§£æå™¨
â”‚   â”œâ”€â”€ data_validator.py        # æ•°æ®éªŒè¯å™¨
â”‚   â”œâ”€â”€ aws_client.py            # AWSå®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ user_manager.py          # ç”¨æˆ·ç®¡ç†å™¨
â”‚   â”œâ”€â”€ group_manager.py         # ç»„ç®¡ç†å™¨
â”‚   â”œâ”€â”€ data_cache.py            # æ•°æ®ç¼“å­˜
â”‚   â”œâ”€â”€ performance_metrics.py   # æ€§èƒ½æŒ‡æ ‡
â”‚   â””â”€â”€ report_generator.py      # æŠ¥å‘Šç”Ÿæˆå™¨
â”‚
â”œâ”€â”€ docs/                         # æ–‡æ¡£ç›®å½•ï¼ˆæ¨èï¼‰
â”‚   â”œâ”€â”€ å…³é”®æŒ‡å¯¼_iam-identity-center-user-update_å¤šå€¼å±æ€§æ›´æ–°é™åˆ¶è¯¦è§£.md
â”‚   â”œâ”€â”€ å¤šå€¼å±æ€§æ›´æ–°æœ€ä½³å®è·µ.md
â”‚   â””â”€â”€ ç”¨æˆ·å±æ€§å‡çº§æŒ‡å—.md
â”‚
â”œâ”€â”€ logs/                         # æ—¥å¿—ç›®å½•ï¼ˆè¿è¡Œæ—¶è‡ªåŠ¨åˆ›å»ºï¼‰
â”‚   â””â”€â”€ subscription_manager.log # ä¸»æ—¥å¿—æ–‡ä»¶
â”‚
â”œâ”€â”€ reports/                      # æŠ¥å‘Šç›®å½•ï¼ˆè¿è¡Œæ—¶è‡ªåŠ¨åˆ›å»ºï¼‰
â”‚   â”œâ”€â”€ execution_record_*.md    # æ‰§è¡Œè®°å½•
â”‚   â”œâ”€â”€ sync_report_*.md         # åŒæ­¥æŠ¥å‘Š
â”‚   â”œâ”€â”€ update_report_*.md       # æ›´æ–°æŠ¥å‘Š
â”‚   â””â”€â”€ failed_users_*.csv       # å¤±è´¥ç”¨æˆ·åˆ—è¡¨
â”‚
â”œâ”€â”€ main.py                       # ä¸»ç¨‹åºå…¥å£ï¼ˆå¿…éœ€ï¼‰
â”œâ”€â”€ requirements.txt              # Pythonä¾èµ–ï¼ˆå¿…éœ€ï¼‰
â”œâ”€â”€ poc-account.config.yaml       # é…ç½®æ–‡ä»¶ï¼ˆå¿…éœ€ï¼‰
â”œâ”€â”€ list.csv                      # ç”¨æˆ·æ¸…å•è®¢é˜…è¡¨ï¼ˆæ•°æ®æ–‡ä»¶ï¼‰
â”œâ”€â”€ README.md                     # é¡¹ç›®è¯´æ˜ï¼ˆæ¨èï¼‰
â”œâ”€â”€ ä½¿ç”¨è¯´æ˜.md                   # ä¸­æ–‡ä½¿ç”¨è¯´æ˜ï¼ˆæ¨èï¼‰
â””â”€â”€ .gitignore                    # Gitå¿½ç•¥é…ç½®ï¼ˆæ¨èï¼‰
```

---

## ğŸ“„ æ ¸å¿ƒæ–‡ä»¶è¯´æ˜

### å¿…éœ€æ–‡ä»¶

| æ–‡ä»¶ | è¯´æ˜ | ç”¨é€” |
|------|------|------|
| `main.py` | ä¸»ç¨‹åºå…¥å£ | å‘½ä»¤è¡Œæ¥å£ï¼Œç¨‹åºå¯åŠ¨ç‚¹ |
| `requirements.txt` | Pythonä¾èµ–åŒ…åˆ—è¡¨ | å®‰è£…ä¾èµ–ï¼š`pip install -r requirements.txt` |
| `poc-account.config.yaml` | AWSé…ç½®æ–‡ä»¶ | AWSè¿æ¥é…ç½®ã€ç»„é…ç½®ç­‰ |
| `src/` | æºä»£ç ç›®å½• | åŒ…å«æ‰€æœ‰ä¸šåŠ¡é€»è¾‘ä»£ç  |

### æ•°æ®æ–‡ä»¶

| æ–‡ä»¶ | è¯´æ˜ | æ ¼å¼ |
|------|------|------|
| `list.csv` | ç”¨æˆ·æ¸…å•è®¢é˜…è¡¨ | CSVæ ¼å¼ï¼ŒåŒ…å«å·¥å·ã€å§“åã€é‚®ç®±ã€è®¢é˜…é¡¹ç›® |

### æ¨èæ–‡ä»¶

| æ–‡ä»¶ | è¯´æ˜ | ç”¨é€” |
|------|------|------|
| `README.md` | é¡¹ç›®è¯´æ˜æ–‡æ¡£ | é¡¹ç›®ä»‹ç»ã€ä½¿ç”¨æ–¹æ³• |
| `ä½¿ç”¨è¯´æ˜.md` | ä¸­æ–‡ä½¿ç”¨è¯´æ˜ | è¯¦ç»†çš„ä¸­æ–‡æ“ä½œæŒ‡å— |
| `.gitignore` | Gitå¿½ç•¥é…ç½® | ç‰ˆæœ¬æ§åˆ¶é…ç½® |
| `docs/` | æ–‡æ¡£ç›®å½• | æŠ€æœ¯æ–‡æ¡£å’Œæœ€ä½³å®è·µ |

### è¿è¡Œæ—¶ç›®å½•

| ç›®å½• | è¯´æ˜ | åˆ›å»ºæ–¹å¼ |
|------|------|---------|
| `logs/` | æ—¥å¿—è¾“å‡ºç›®å½• | ç¨‹åºè¿è¡Œæ—¶è‡ªåŠ¨åˆ›å»º |
| `reports/` | æŠ¥å‘Šè¾“å‡ºç›®å½• | ç¨‹åºè¿è¡Œæ—¶è‡ªåŠ¨åˆ›å»º |

---

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆå¯é€‰ä½†æ¨èï¼‰
python3 -m venv venv
source venv/bin/activate  # Linux/Mac
# æˆ–
venv\Scripts\activate  # Windows

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### 2. é…ç½®AWS

```bash
# é…ç½®AWSå‡­è¯
aws configure --profile oversea1

# æµ‹è¯•è¿æ¥
python3 main.py test --config poc-account.config.yaml
```

### 3. å‡†å¤‡æ•°æ®

ç¡®ä¿ `list.csv` æ–‡ä»¶æ ¼å¼æ­£ç¡®ï¼š
```csv
å·¥å·,å§“å,é‚®ç®±,è®¢é˜…é¡¹ç›®
21033151,ç‹å­˜å±±,wangcunshan@haier1.com,KIROè®¢é˜…
20023656,å•æˆé”‹,lvchengfeng@haier1.com,QDEVè®¢é˜…
```

### 4. è¿è¡Œç¨‹åº

```bash
# è¯•è¿è¡Œï¼ˆæ¨èé¦–æ¬¡ä½¿ç”¨ï¼‰
python3 main.py process list.csv --dry-run --config poc-account.config.yaml

# æ­£å¼è¿è¡Œ
python3 main.py process list.csv --syncusers --config poc-account.config.yaml
```

---

## ğŸ“‹ é…ç½®æ–‡ä»¶è¯´æ˜

### poc-account.config.yaml

```yaml
aws:
  profile: oversea1              # AWSé…ç½®æ–‡ä»¶å
  region: us-east-1              # AWSåŒºåŸŸ
  identity_center:
    instance_id: ssoins-xxx      # Identity Centerå®ä¾‹ID

groups:
  kiro: Group_KIRO_eu-central-1  # KIROç»„å
  qdev: Group_QDEV_eu-central-1  # QDEVç»„å

user_format:
  username_template: "{employee_id}@haier-saml.com"
  use_new_format: true           # ä½¿ç”¨æ–°æ ¼å¼

logging:
  level: INFO                    # æ—¥å¿—çº§åˆ«
  file: logs/subscription_manager.log

retry:
  max_attempts: 3                # æœ€å¤§é‡è¯•æ¬¡æ•°
  backoff_factor: 2.0            # é€€é¿å› å­
```

---

## ğŸ”§ å¸¸ç”¨å‘½ä»¤

### åŸºæœ¬æ“ä½œ

```bash
# æŸ¥çœ‹å¸®åŠ©
python3 main.py --help

# æµ‹è¯•AWSè¿æ¥
python3 main.py test --config poc-account.config.yaml

# è¯•è¿è¡Œ
python3 main.py process list.csv --dry-run --config poc-account.config.yaml
```

### ç”¨æˆ·åŒæ­¥

```bash
# åŒæ­¥ç”¨æˆ·ï¼ˆæ¨èï¼‰
python3 main.py process list.csv --syncusers --config poc-account.config.yaml

# åŒæ­¥ç”¨æˆ·ï¼ˆè¯•è¿è¡Œï¼‰
python3 main.py process list.csv --syncusers --dry-run --config poc-account.config.yaml
```

### é«˜çº§é€‰é¡¹

```bash
# è¯¦ç»†æ—¥å¿—æ¨¡å¼
python3 main.py process list.csv --syncusers --verbose --config poc-account.config.yaml

# ç®€åŒ–æ—¥å¿—æ¨¡å¼
python3 main.py process list.csv --syncusers --quiet --config poc-account.config.yaml

# è‡ªå®šä¹‰å¹¶å‘æ•°
python3 main.py process list.csv --syncusers --max-workers 3 --config poc-account.config.yaml
```

---

## ğŸ“Š è¾“å‡ºæ–‡ä»¶

### æ—¥å¿—æ–‡ä»¶

**ä½ç½®**: `logs/subscription_manager.log`

**å†…å®¹**:
- ç¨‹åºè¿è¡Œæ—¥å¿—
- æ“ä½œè¯¦æƒ…
- é”™è¯¯ä¿¡æ¯
- æ€§èƒ½æŒ‡æ ‡

### æŠ¥å‘Šæ–‡ä»¶

**ä½ç½®**: `reports/`

**ç±»å‹**:
- `execution_record_*.md` - æ‰§è¡Œè®°å½•ï¼ˆåŒ…å«æ‰€æœ‰æ“ä½œè¯¦æƒ…ï¼‰
- `sync_report_*.md` - åŒæ­¥æŠ¥å‘Šï¼ˆåŒæ­¥æ“ä½œç»“æœï¼‰
- `update_report_*.md` - æ›´æ–°æŠ¥å‘Šï¼ˆæ›´æ–°æ“ä½œç»“æœï¼‰
- `delete_report_*.md` - åˆ é™¤æŠ¥å‘Šï¼ˆåˆ é™¤æ“ä½œç»“æœï¼‰
- `verification_report_*.md` - éªŒè¯æŠ¥å‘Šï¼ˆæ•°æ®ä¸€è‡´æ€§éªŒè¯ï¼‰
- `failed_users_*.csv` - å¤±è´¥ç”¨æˆ·åˆ—è¡¨ï¼ˆå¦‚æœ‰å¤±è´¥ï¼‰

---

## ğŸ”’ å®‰å…¨æ³¨æ„äº‹é¡¹

### æ•æ„Ÿæ–‡ä»¶

ä»¥ä¸‹æ–‡ä»¶åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼Œ**ä¸è¦æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶**ï¼š

1. `poc-account.config.yaml` - åŒ…å«AWSé…ç½®
2. `list.csv` - åŒ…å«çœŸå®ç”¨æˆ·æ•°æ®
3. `logs/` - å¯èƒ½åŒ…å«æ•æ„Ÿæ—¥å¿—
4. `reports/` - å¯èƒ½åŒ…å«ç”¨æˆ·ä¿¡æ¯

### .gitignore é…ç½®

```gitignore
# é…ç½®æ–‡ä»¶ï¼ˆåŒ…å«æ•æ„Ÿä¿¡æ¯ï¼‰
poc-account.config.yaml
*-account.config.yaml

# æ•°æ®æ–‡ä»¶
list.csv
*.csv

# è¿è¡Œæ—¶æ–‡ä»¶
logs/
reports/
*.log

# Python
__pycache__/
*.pyc
*.pyo
venv/
env/
```

---

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

### ç³»ç»Ÿæ€§èƒ½

| æ“ä½œ | æ€§èƒ½ | è¯´æ˜ |
|------|------|------|
| ç”¨æˆ·åˆ›å»º | 1.5ç”¨æˆ·/ç§’ | å•ä¸ªç”¨æˆ·åˆ›å»º |
| ç”¨æˆ·æ›´æ–° | 1.0ç”¨æˆ·/ç§’ | å•ä¸ªç”¨æˆ·æ›´æ–° |
| ç”¨æˆ·åˆ é™¤ | 1.5ç”¨æˆ·/ç§’ | å•ä¸ªç”¨æˆ·åˆ é™¤ |
| æ•°æ®ç¼“å­˜ | 335ç”¨æˆ·/4ç§’ | æ‰¹é‡æ•°æ®è·å– |
| 324ç”¨æˆ·åŒæ­¥ | <15åˆ†é’Ÿ | é¢„ä¼°æ—¶é—´ |

### ä¼˜åŒ–å»ºè®®

1. **å°è§„æ¨¡æ“ä½œ**ï¼ˆ<100ç”¨æˆ·ï¼‰ï¼šå¯ç›´æ¥æ‰§è¡Œ
2. **ä¸­è§„æ¨¡æ“ä½œ**ï¼ˆ100-300ç”¨æˆ·ï¼‰ï¼šå»ºè®®ç›‘æ§æ—¥å¿—
3. **å¤§è§„æ¨¡æ“ä½œ**ï¼ˆ>300ç”¨æˆ·ï¼‰ï¼šå»ºè®®åˆ†æ‰¹æ‰§è¡Œ

---

## ğŸ†˜ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **AWSå‡­è¯é”™è¯¯**
   ```
   è§£å†³: aws configure --profile oversea1
   ```

2. **CSVæ–‡ä»¶ç¼–ç é—®é¢˜**
   ```
   è§£å†³: ç¡®ä¿CSVæ–‡ä»¶ä½¿ç”¨UTF-8ç¼–ç 
   ```

3. **æƒé™ä¸è¶³**
   ```
   è§£å†³: æ£€æŸ¥AWSç”¨æˆ·æƒé™
   ```

4. **ç»„ä¸å­˜åœ¨**
   ```
   è§£å†³: åœ¨IAM Identity Centerä¸­åˆ›å»ºç›¸åº”çš„ç»„
   ```

### æ—¥å¿—æŸ¥çœ‹

```bash
# å®æ—¶æŸ¥çœ‹æ—¥å¿—
tail -f logs/subscription_manager.log

# æŸ¥çœ‹å®Œæ•´æ—¥å¿—
cat logs/subscription_manager.log

# æœç´¢é”™è¯¯
grep "ERROR" logs/subscription_manager.log
```

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### æ–‡æ¡£èµ„æº

- [README.md](README.md) - é¡¹ç›®è¯´æ˜
- [ä½¿ç”¨è¯´æ˜.md](ä½¿ç”¨è¯´æ˜.md) - ä¸­æ–‡ä½¿ç”¨æŒ‡å—
- [docs/](docs/) - æŠ€æœ¯æ–‡æ¡£

### ç³»ç»ŸçŠ¶æ€

- **ç‰ˆæœ¬**: 1.0
- **æµ‹è¯•çŠ¶æ€**: âœ… æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•å®Œæˆ
- **ç³»ç»Ÿè¯„åˆ†**: 9.3/10
- **æŠ•äº§çŠ¶æ€**: âœ… å¯ç«‹å³æŠ•äº§

---

## ğŸ“ ç»´æŠ¤å»ºè®®

### å®šæœŸç»´æŠ¤

1. **æ—¥å¿—æ¸…ç†**: å®šæœŸæ¸…ç†æ—§æ—¥å¿—æ–‡ä»¶
2. **æŠ¥å‘Šå½’æ¡£**: å®šæœŸå½’æ¡£æ—§æŠ¥å‘Šæ–‡ä»¶
3. **æ•°æ®å¤‡ä»½**: å®šæœŸå¤‡ä»½ç”¨æˆ·æ•°æ®
4. **é…ç½®æ£€æŸ¥**: å®šæœŸæ£€æŸ¥é…ç½®æ–‡ä»¶

### ç›‘æ§å»ºè®®

1. ç›‘æ§æ—¥å¿—æ–‡ä»¶å¤§å°
2. ç›‘æ§æŠ¥å‘Šç”Ÿæˆæƒ…å†µ
3. ç›‘æ§æ“ä½œæˆåŠŸç‡
4. ç›‘æ§ç³»ç»Ÿæ€§èƒ½

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**æœ€åæ›´æ–°**: 2025-12-01  
**çŠ¶æ€**: âœ… ç”Ÿäº§å°±ç»ª
